<!DOCTYPE html>
<html>
<head>
  <title>Wallet Platform</title>
  <style>
    body { font-family: Arial; margin: 50px; background: #f4f4f4; }
    .container { max-width: 400px; margin: auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h2 { text-align: center; }
    input, select { width: 100%; padding: 10px; margin: 8px 0; }
    button { width: 100%; padding: 10px; background: #28a745; color: white; border: none; margin-top: 10px; }
    .switch { text-align: center; margin-top: 15px; }
    .error { color: red; text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <h2 id="formTitle">Login</h2>

    <div id="error" class="error"></div>

    <div id="loginForm">
      <input type="email" id="loginEmail" placeholder="Email" required>
      <input type="password" id="loginPassword" placeholder="Password" required>
      <button onclick="login()">Login</button>
    </div>

    <div id="registerForm" style="display:none;">
      <input type="text" id="regName" placeholder="Full Name" required>
      <input type="email" id="regEmail" placeholder="Email" required>
      <input type="password" id="regPassword" placeholder="Password" required>
      <input type="text" id="regWallet" placeholder="Preferred Wallet Number" required>
      <button onclick="register()">Register</button>
    </div>

    <div class="switch">
      <a href="#" onclick="toggleForm()">Switch to <span id="toggleText">Register</span></a>
    </div>
  </div>

  <script>
    function toggleForm() {
      const loginForm = document.getElementById('loginForm');
      const registerForm = document.getElementById('registerForm');
      const formTitle = document.getElementById('formTitle');
      const toggleText = document.getElementById('toggleText');
      document.getElementById('error').textContent = '';

      if (loginForm.style.display === "none") {
        loginForm.style.display = "block";
        registerForm.style.display = "none";
        formTitle.textContent = "Login";
        toggleText.textContent = "Register";
      } else {
        loginForm.style.display = "none";
        registerForm.style.display = "block";
        formTitle.textContent = "Register";
        toggleText.textContent = "Login";
      }
    }

    function register() {
      const name = document.getElementById('regName').value.trim();
      const email = document.getElementById('regEmail').value.trim().toLowerCase();
      const password = document.getElementById('regPassword').value;
      const wallet = document.getElementById('regWallet').value.trim();
      const errorDiv = document.getElementById('error');

      if (!name || !email || !password || !wallet) {
        errorDiv.textContent = "Please fill in all fields.";
        return;
      }

      let users = JSON.parse(localStorage.getItem('users') || '[]');
      if (users.find(u => u.email === email)) {
        errorDiv.textContent = "Email is already registered.";
        return;
      }

      users.push({ name, email, password, wallet, balance: 0, transactions: [] });
      localStorage.setItem('users', JSON.stringify(users));
      errorDiv.style.color = "green";
      errorDiv.textContent = "Registration successful. You can now login.";
      toggleForm();
    }

    function login() {
      const email = document.getElementById('loginEmail').value.trim().toLowerCase();
      const password = document.getElementById('loginPassword').value;
      const errorDiv = document.getElementById('error');

      if (email === "admin@wallet.com" && password === "admin123") {
        sessionStorage.setItem('adminLoggedIn', true);
        window.location.href = "admin-dashboard.html";
        return;
      }

      let users = JSON.parse(localStorage.getItem('users') || '[]');
      const user = users.find(u => u.email === email && u.password === password);

      if (user) {
        sessionStorage.setItem('loggedInUser', email);
        window.location.href = "dashboard.html";
      } else {
        errorDiv.textContent = "Invalid email or password. Please try again.";
      }
    }

    // Auto-login redirection
    window.onload = function () {
      if (sessionStorage.getItem('loggedInUser')) {
        window.location.href = "dashboard.html";
      }
      if (sessionStorage.getItem('adminLoggedIn')) {
        window.location.href = "admin-dashboard.html";
      }
    };
  </script>
</body>
</html>
