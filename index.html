<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Wallet Platform</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f0f0f0; }
    #login, #dashboard { display: none; max-width: 400px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h2 { text-align: center; }
    input, button { width: 100%; padding: 10px; margin: 8px 0; border-radius: 4px; border: 1px solid #ccc; }
    #logoutBtn { background: #d9534f; color: white; }
    .admin-section { background: #eef; padding: 10px; border: 1px dashed #99c; margin-top: 15px; }
  </style>
</head>
<body>

  <div id="login">
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Username (e.g. kilush)">
    <input type="password" id="password" placeholder="Password">
    <button onclick="login()">Login</button>
    <p id="loginError" style="color:red; text-align:center;"></p>
  </div>

  <div id="dashboard">
    <h2 id="welcomeUser">Welcome</h2>
    <p><strong>Wallet Number:</strong> <span id="walletNum"></span></p>
    <p><strong>Balance:</strong> <span id="balance"></span></p>

    <div id="transferSection">
      <h3>Transfer Money</h3>
      <input type="text" id="recipientWallet" placeholder="Recipient Wallet Number">
      <input type="number" id="transferAmount" placeholder="Amount to Send">
      <button onclick="sendMoney()">Send</button>
      <p id="transferMsg" style="color:green;"></p>
    </div>

    <div class="admin-section" id="adminPanel" style="display:none;">
      <h3>Admin Controls</h3>
      <p>Admin-only dashboard view is active.</p>
    </div>

    <button id="logoutBtn" onclick="logout()">Logout</button>
  </div>

  <script>
    const users = {
      admin: { password: "admin123", wallet: "ADM001", balance: 100000 },
      kilush: { password: "kilush123", wallet: "KIL001", balance: 5000 },
      schwadz: { password: "schwadz123", wallet: "SCH001", balance: 7000 },
    };

    let currentUser = null;

    window.onload = () => {
      document.getElementById("login").style.display = "block";
    };

    function login() {
      const uname = document.getElementById("username").value.trim().toLowerCase();
      const pwd = document.getElementById("password").value.trim();

      if (!uname || !pwd) {
        showError("Please fill all fields");
        return;
      }

      if (users[uname] && users[uname].password === pwd) {
        currentUser = uname;
        showDashboard();
      } else {
        showError("Incorrect username or password");
      }
    }

    function showDashboard() {
      document.getElementById("login").style.display = "none";
      document.getElementById("dashboard").style.display = "block";

      const user = users[currentUser];
      document.getElementById("welcomeUser").textContent = `Welcome, ${currentUser.toUpperCase()}`;
      document.getElementById("walletNum").textContent = user.wallet;
      document.getElementById("balance").textContent = `KES ${user.balance.toLocaleString()}`;

      document.getElementById("adminPanel").style.display = (currentUser === "admin") ? "block" : "none";
    }

    function logout() {
      currentUser = null;
      document.getElementById("dashboard").style.display = "none";
      document.getElementById("login").style.display = "block";
      document.getElementById("username").value = "";
      document.getElementById("password").value = "";
      document.getElementById("loginError").textContent = "";
      document.getElementById("transferMsg").textContent = "";
    }

    function showError(msg) {
      document.getElementById("loginError").textContent = msg;
    }

    function sendMoney() {
      const recipientWallet = document.getElementById("recipientWallet").value.trim().toUpperCase();
      const amount = parseFloat(document.getElementById("transferAmount").value.trim());

      if (!recipientWallet || isNaN(amount) || amount <= 0) {
        document.getElementById("transferMsg").textContent = "Enter valid recipient and amount";
        return;
      }

      const sender = users[currentUser];

      if (amount > sender.balance) {
        document.getElementById("transferMsg").textContent = "Insufficient balance";
        return;
      }

      // Find recipient
      let recipientUser = null;
      for (let key in users) {
        if (users[key].wallet === recipientWallet) {
          recipientUser = key;
          break;
        }
      }

      if (!recipientUser) {
        document.getElementById("transferMsg").textContent = "Recipient not found";
        return;
      }

      // Transfer funds
      sender.balance -= amount;
      users[recipientUser].balance += amount;

      document.getElementById("balance").textContent = `KES ${sender.balance.toLocaleString()}`;
      document.getElementById("transferMsg").textContent = `Successfully sent KES ${amount} to ${recipientUser.toUpperCase()}`;
      document.getElementById("recipientWallet").value = "";
      document.getElementById("transferAmount").value = "";
    }
  </script>
</body>
</html>
